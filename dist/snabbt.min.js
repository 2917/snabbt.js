/*! snabbt.js 2014-05-25 */
function requestAnimFrame(a){tick_requests.push(a)}function master_tick(a){for(var b=tick_requests.length,c=0;b>c;++c)tick_requests[c](a);tick_requests.splice(0,b),window.requestAnimationFrame(master_tick)}function pos_from_options(a,b,c){return b[c+"pos"]&&(a.x=b[c+"pos"][0],a.y=b[c+"pos"][1],a.z=b[c+"pos"][2]),b[c+"rot"]&&(a.ax=b[c+"rot"][0],a.ay=b[c+"rot"][1],a.az=b[c+"rot"][2]),b[c+"rot_post"]&&(a.bx=b[c+"rot_post"][0],a.by=b[c+"rot_post"][1],a.bz=b[c+"rot_post"][2]),a}function snabbt(a,b){function c(i){g.tick(i);var j=g.current_transform();if(snabbtjs.set_css_transform(a,j.as_matrix()),g.completed()){var k=g.end_position();snabbtjs.set_css_transform(a,k.as_matrix()),b.loop>1?(b.loop-=1,g=new snabbtjs.Animation(f),requestAnimFrame(c)):(b.callback&&b.callback(),h.length&&(b=h.pop(),d=pos_from_options(e,b,"from_"),e=pos_from_options(new snabbtjs.Position({}),b,""),g=new snabbtjs.Animation({start_pos:d,end_pos:e,duration:b.duration||1e3,delay:b.delay||0,offset:b.offset}),b.easing&&(g.easing=snabbtjs.EASING_FUNCS[b.easing]),requestAnimFrame(c)))}else requestAnimFrame(c)}var d=new snabbtjs.Position({});d=pos_from_options(d,b,"from_");var e=new snabbtjs.Position({});e=pos_from_options(e,b,"");var f={start_pos:d,end_pos:e,duration:b.duration||1e3,delay:b.delay||0,offset:b.offset};b.easing&&(f.easing=snabbtjs.EASING_FUNCS[b.easing]);var g=new snabbtjs.Animation(f),h=[],i={then:function(a){return h.unshift(a),i}};return requestAnimFrame(c),i}var snabbtjs=snabbtjs||{};snabbtjs.Animation=function(a){this.start_pos=a.start_pos||new snabbtjs.Position({}),this.end_pos=a.end_pos||new snabbtjs.Position({}),this.offset=a.offset,this.duration=a.duration||500,this.delay=a.delay||0,this.easing=a.easing||snabbtjs.linear_easing,this.transition=a.transition||snabbtjs.closest,this.start_time=0,this.current_time=0},snabbtjs.Animation.prototype.tick=function(a){this.start_time||(this.start_time=a),a-this.start_time>this.delay&&(this.current_time=a-this.delay)},snabbtjs.Animation.prototype.current_transform=function(){var a=Math.min(Math.max(.001,this.current_time-this.start_time),this.duration),b=this.duration,c=this.transition(this.start_pos,this.end_pos,a,b,this.easing);return this.offset&&(c.offset_x+=this.offset[0],c.offset_y+=this.offset[1],c.offset_z+=this.offset[2]),c},snabbtjs.Animation.prototype.completed=function(){return 0===this.start_time?!1:this.current_time-this.start_time>this.duration},snabbtjs.Animation.prototype.end_position=function(){var a=this.end_pos;return this.offset&&(a.offset_x+=this.offset[0],a.offset_y+=this.offset[1],a.offset_z+=this.offset[2]),a},snabbtjs.closest=function(a,b,c,d){var e=b.x-a.x,f=b.y-a.y,g=b.z-a.z,h=b.ax-a.ax,i=b.ay-a.ay,j=b.az-a.az,k=b.bx-a.bx,l=b.by-a.by,m=b.bz-a.bz,n=this.easing(c,d),o=new snabbtjs.Position({ax:a.ax+n*h,ay:a.ay+n*i,az:a.az+n*j,x:a.x+n*e,y:a.y+n*f,z:a.z+n*g,bx:a.bx+n*k,by:a.by+n*l,bz:a.bz+n*m});return o};var snabbtjs=snabbtjs||{};snabbtjs.pow2_easing=function(a,b){return Math.pow(a/b,.5)},snabbtjs.linear_easing=function(a,b){return a/b},snabbtjs.cos_easing=function(a,b){return(Math.cos(a/b*Math.PI+Math.PI)+1)/2},snabbtjs.create_cubic_bezier_easing=function(a,b,c,d){return function(e,f){var g=e/f;return 3*Math.pow(1-g,2)*g*(a+b)+3*(1-g)*Math.pow(g,2)*(c+d)+Math.pow(g,3)}},snabbtjs.cubic_easing=function(a,b){var c=a/b;return(Math.pow(2*c-1,3)+1)/2},snabbtjs.cos_wooble_easing=function(a,b){var c=a/b;return c*Math.cos(4*Math.PI*c)},snabbtjs.atan_easing=function(a,b){var c=a/b;return(Math.atan(Math.PI*c-Math.PI/2)+1)/2},snabbtjs.sinc_wobbler_easing=function(a,b){var c=a/b,d=5;return(-Math.sin(d*Math.PI*c)/(d*c)+Math.PI)/Math.PI},snabbtjs.sinc2=function(a,b){var c=a/b;return 1-Math.sin(20*Math.PI*c)/(20*Math.PI*c)},snabbtjs.EASING_FUNCS={linear:snabbtjs.linear_easing,cubic:snabbtjs.cubic_easing,atan:snabbtjs.atan_easing,cos:snabbtjs.cos_easing,sinc_wobbler:snabbtjs.sinc_wobbler_easing,sinc2_wobbler:snabbtjs.sinc2,c2:snabbtjs.create_cubic_bezier_easing(.78,.205,.1,1)};var tick_requests=[];window.requestAnimationFrame(master_tick);var snabbtjs=snabbtjs||{};snabbtjs.Matrix=function(a){this.m=a},snabbtjs.Matrix.prototype.mult=function(a){var b=[Array(4),Array(4),Array(4),Array(4)];return b[0][0]=this.m[0][0]*a.m[0][0]+this.m[0][1]*a.m[1][0]+this.m[0][2]*a.m[2][0]+this.m[0][3]*a.m[3][0],b[0][1]=this.m[0][0]*a.m[0][1]+this.m[0][1]*a.m[1][1]+this.m[0][2]*a.m[2][1]+this.m[0][3]*a.m[3][1],b[0][2]=this.m[0][0]*a.m[0][2]+this.m[0][1]*a.m[1][2]+this.m[0][2]*a.m[2][2]+this.m[0][3]*a.m[3][2],b[0][3]=this.m[0][0]*a.m[0][3]+this.m[0][1]*a.m[1][3]+this.m[0][2]*a.m[2][3]+this.m[0][3]*a.m[3][3],b[1][0]=this.m[1][0]*a.m[0][0]+this.m[1][1]*a.m[1][0]+this.m[1][2]*a.m[2][0]+this.m[1][3]*a.m[3][0],b[1][1]=this.m[1][0]*a.m[0][1]+this.m[1][1]*a.m[1][1]+this.m[1][2]*a.m[2][1]+this.m[1][3]*a.m[3][1],b[1][2]=this.m[1][0]*a.m[0][2]+this.m[1][1]*a.m[1][2]+this.m[1][2]*a.m[2][2]+this.m[1][3]*a.m[3][2],b[1][3]=this.m[1][0]*a.m[0][3]+this.m[1][1]*a.m[1][3]+this.m[1][2]*a.m[2][3]+this.m[1][3]*a.m[3][3],b[2][0]=this.m[2][0]*a.m[0][0]+this.m[2][1]*a.m[1][0]+this.m[2][2]*a.m[2][0]+this.m[2][3]*a.m[3][0],b[2][1]=this.m[2][0]*a.m[0][1]+this.m[2][1]*a.m[1][1]+this.m[2][2]*a.m[2][1]+this.m[2][3]*a.m[3][1],b[2][2]=this.m[2][0]*a.m[0][2]+this.m[2][1]*a.m[1][2]+this.m[2][2]*a.m[2][2]+this.m[2][3]*a.m[3][2],b[2][3]=this.m[2][0]*a.m[0][3]+this.m[2][1]*a.m[1][3]+this.m[2][2]*a.m[2][3]+this.m[2][3]*a.m[3][3],b[3][0]=this.m[3][0]*a.m[0][0]+this.m[3][1]*a.m[1][0]+this.m[3][2]*a.m[2][0]+this.m[3][3]*a.m[3][0],b[3][1]=this.m[3][0]*a.m[0][1]+this.m[3][1]*a.m[1][1]+this.m[3][2]*a.m[2][1]+this.m[3][3]*a.m[3][1],b[3][2]=this.m[3][0]*a.m[0][2]+this.m[3][1]*a.m[1][2]+this.m[3][2]*a.m[2][2]+this.m[3][3]*a.m[3][2],b[3][3]=this.m[3][0]*a.m[0][3]+this.m[3][1]*a.m[1][3]+this.m[3][2]*a.m[2][3]+this.m[3][3]*a.m[3][3],new snabbtjs.Matrix(b)},snabbtjs.mat_to_css=function(a){var b="matrix3d("+a[0][0].toFixed(10)+", "+a[0][1].toFixed(10)+", "+a[0][2].toFixed(10)+", "+a[0][3].toFixed(10)+", "+a[1][0].toFixed(10)+", "+a[1][1].toFixed(10)+", "+a[1][2].toFixed(10)+", "+a[1][3].toFixed(10)+", "+a[2][0].toFixed(10)+", "+a[2][1].toFixed(10)+", "+a[2][2].toFixed(10)+", "+a[2][3].toFixed(10)+", "+a[3][0].toFixed(10)+", "+a[3][1].toFixed(10)+", "+a[3][2].toFixed(10)+", "+a[3][3].toFixed(10)+")";return b},snabbtjs.rotX=function(a){return new snabbtjs.Matrix([[1,0,0,0],[0,Math.cos(a),-Math.sin(a),0],[0,Math.sin(a),Math.cos(a),0],[0,0,0,1]])},snabbtjs.rotY=function(a){return new snabbtjs.Matrix([[Math.cos(a),0,Math.sin(a),0],[0,1,0,0],[-Math.sin(a),0,Math.cos(a),0],[0,0,0,1]])},snabbtjs.rotZ=function(a){return new snabbtjs.Matrix([[Math.cos(a),-Math.sin(a),0,0],[Math.sin(a),Math.cos(a),0,0],[0,0,1,0],[0,0,0,1]])},snabbtjs.trans=function(a,b,c){return new snabbtjs.Matrix([[1,0,0,0],[0,1,0,0],[0,0,1,0],[a,b,c,1]])},snabbtjs.scale=function(a,b,c){return new snabbtjs.Matrix([[a,0,0,0],[0,b,0,0],[0,0,c,0],[0,0,0,1]])},snabbtjs.ident=function(){return new snabbtjs.Matrix([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]])},snabbtjs.set_css_transform=function(a,b){if(a instanceof Array)for(var c=0;c<a.length;++c)a[c].style.webkitTransform=mat_to_css(b),a[c].style.transform=mat_to_css(b);else a.style.webkitTransform=snabbtjs.mat_to_css(b),a.style.transform=snabbtjs.mat_to_css(b)},snabbtjs.Position=function(a){this.ax=a.ax||0,this.ay=a.ay||0,this.az=a.az||0,this.x=a.x||0,this.y=a.y||0,this.z=a.z||0,this.bx=a.bx||0,this.by=a.by||0,this.bz=a.bz||0,this.offset_x=a.offset_x||0,this.offset_y=a.offset_y||0,this.offset_z=a.offset_z||0},snabbtjs.Position.prototype.clone=function(){var a=new snabbtjs.Position({ax:this.ax,ay:this.ay,az:this.az,x:this.x,y:this.y,z:this.z,bx:this.bx,by:this.by,bz:this.bz});return a},snabbtjs.Position.prototype.as_matrix=function(){var a=snabbtjs.ident();return a=a.mult(snabbtjs.rotX(this.ax)),a=a.mult(snabbtjs.rotY(this.ay)),a=a.mult(snabbtjs.rotZ(this.az)),a=a.mult(snabbtjs.trans(this.x,this.y,this.z)),a=a.mult(snabbtjs.rotY(this.by)),a=a.mult(snabbtjs.rotX(this.bx)),a=a.mult(snabbtjs.rotZ(this.bz)),a=a.mult(snabbtjs.trans(this.offset_x,this.offset_y,this.offset_z)),a.m};